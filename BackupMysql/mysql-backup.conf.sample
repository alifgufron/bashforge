# Configuration for mysql-backup.sh
# This is a sample configuration file. Copy it to mysql-backup.conf and modify as needed.

# --- MySQL Connection ---
# MySQL user with backup privileges.
MYSQL_USER="userbackup"
# Password for the MySQL user.
# SECURITY WARNING: Storing passwords in plaintext is a risk. Ensure this file has strict permissions.
MYSQL_PASS="yourpassword"
# MySQL host address (e.g., 127.0.0.1, localhost, or remote IP/hostname).
MYSQL_HOST="127.0.0.1"

# MySQL port. Leave empty to use the default port (3306).
MYSQL_PORT=""

# The command to use for mysqldump. Can be a name in PATH or an absolute path.
# This is useful if you have multiple versions of mysqldump installed.
# Example: MYSQLDUMP_CMD="mysqldump57"
# Example: MYSQLDUMP_CMD="/usr/local/bin/mysqldump80"
MYSQLDUMP_CMD="mysqldump"

# Extra options for mysqldump. These are appended to the command.
# The default options are recommended for modern MySQL/MariaDB with InnoDB tables.
#
# --single-transaction: Creates a consistent snapshot of InnoDB tables without locking them.
#                         May not work for MyISAM tables.
# -R, --routines:       Includes stored procedures and functions in the dump.
# -K, --triggers:       Includes triggers for each dumped table.
# --set-gtid-purged=OFF: Prevents GTID information from being added to the dump, which can
#                        cause issues when restoring to a server that is not part of the
#                        original replication setup. Remove if you are using GTID replication.
#
# Example for older MySQL 5.1 (without GTID support):
# MYSQLDUMP_EXTRA_OPTS="--single-transaction -R -K --triggers"
#
# Example for a very basic dump (if you encounter errors):
# MYSQLDUMP_EXTRA_OPTS=""
MYSQLDUMP_EXTRA_OPTS="--single-transaction -R -K --triggers --set-gtid-purged=OFF"

# --- Backup Scope ---
# Set to "yes" to automatically back up all databases found on the server.
# If "no", the script will only back up the databases listed in the DATABASES array.
BACKUP_ALL_DATABASES="no"

# A list of specific databases to back up if BACKUP_ALL_DATABASES is "no".
# This array is ignored if BACKUP_ALL_DATABASES is "yes".
# Example: DATABASES=("db1" "db2")
DATABASES=("db1")

# A list of databases to exclude when BACKUP_ALL_DATABASES is "yes".
# System databases like 'information_schema', 'mysql', 'performance_schema', 'sys' are good candidates for exclusion.
EXCLUDE_DATABASES=("information_schema" "mysql" "performance_schema" "sys")

# --- Storage & Compression ---
# Absolute path for storing all backups.
BACKUP_PATH="/BACKUP_DIR/DATABASES"

# Enable or disable compression. Options: "yes", "no"
# If "no", the script will store raw .sql files.
COMPRESSION_ENABLED="yes"

# Compression strategy. Options:
# "per_database" - Each database is compressed into its own archive (e.g., db1.tar.gz, db2.tar.gz).
# "per_job"      - All successful database dumps from a single run are combined into one archive (e.g., 20.tar.gz).
# Only relevant if COMPRESSION_ENABLED="yes".
COMPRESSION_STRATEGY="per_database"

# Compression type. Affects file size and compression/decompression speed.
# Options: "gzip", "bzip2", "xz"
# Only relevant if COMPRESSION_ENABLED="yes".
COMPRESSION_TYPE="gzip"

# Whether to append a unique ID to backup filenames. Useful for multiple backups per day.
# If "yes", filenames will be like 'db_name_UNIQUEID.tar.gz' or 'DD_UNIQUEID.tar.gz'.
# If "no", filenames will be 'db_name.tar.gz' or 'DD.tar.gz'.
UNIQUE_ID_ENABLED="no"

# --- Retention ---
# Number of recent backup files/archives to keep. Older ones will be deleted.
# This is applied based on the COMPRESSION_STRATEGY and UNIQUE_ID_ENABLED settings.
# Set to 0 to disable cleanup entirely (no old backups will be deleted).
# Note: If UNIQUE_ID_ENABLED="no", RETENTION_COUNT is ignored, and no old backups will be cleaned up.
RETENTION_COUNT=7

# --- Pre-flight Checks ---
# Minimum required free disk space in Gigabytes (GB) in the BACKUP_PATH.
# The script will exit if available space is below this value.
MIN_DISK_SPACE_GB=2

# --- Notifications ---
# Email address for sending status reports.
MAIL_TO="admin@example"

# Custom "From" address for notification emails.
# If left empty, defaults to "mysql-backup@<hostname>".
MAIL_FROM=""

# Whether to send a notification email when the backup process starts.
# Options: "yes" or "no".
NOTIFY_ON_START="yes"
